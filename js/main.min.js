//@prepros-append pages/common.js
//@prepros-append pages/mmenu.js
//@prepros-append pages/banner.js
//@prepros-append pages/index.js
//@prepros-append pages/popup.js
// common.js
function getNumber(str) {
    return parseInt(str.replace(/\s/g, ''));
}

function number_format(number, decimals, dec_point, thousands_sep) {
    var i, j, kw, kd, km;
    if (isNaN(decimals = Math.abs(decimals))) {
        decimals = 2;
    }
    if (dec_point == undefined) {
        dec_point = ",";
    }
    if (thousands_sep == undefined) {
        thousands_sep = ".";
    }
    i = parseInt(number = (+number || 0).toFixed(decimals)) + "";
    if ((j = i.length) > 3) {
        j = j % 3;
    } else {
        j = 0;
    }
    km = (j ? i.substr(0, j) + thousands_sep : "");
    kw = i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousands_sep);
    kd = (decimals ? dec_point + Math.abs(number - i).toFixed(decimals).replace(/-/, 0).slice(2) : "");
    return km + kw + kd;
}

function imageResize(src) {
    $('img').not('.logo__img').attr('src', src);
}
// imageResize('https://loremflickr.com/320/440');

const wWidth = $(window).width();

function getSuccess() {
    let template = $(tmpl.content),
        loader = template.find('.success').clone();
    return loader;
}

$.validator.methods.tel = function (value, element) {
    return validateTel(value);
};
function validateTel(value) {
    let re = new RegExp(/\d/g),
        str = value.match(re);

    if (str.length == 11) {
        return true;
    } else {
        return false;
    }
}

$('input[type=tel]').mask('+7 (999) 999-99-99');

const popup = $('.popup'),
    popupWrap = popup.find('.popup__wrapper');

function getForm(cls) {
    let template = $(tmpl.content),
        form = template.find(cls).clone();
    return form;
}

function openForm(form) {
    popupWrap.html(form);
    popup.addClass('active');
    $('body').addClass('ovh');
}

function closePopup() {
    popup.removeClass('active');
    $('body').removeClass('ovh');
}
//mmenu.js
$(function () {

    // VARIABLES

    // EVENTS
    // Переходм между вкладками
    $('.mmenu__link_arr').on('click', function (e) {
        e.preventDefault();
        let link = $(this),
            wrapper = link.next();

        wrapper.addClass('active');
    });

    //Закрытие вкладки
    $('.jsWrapClose').on('click', function (e) {
        e.preventDefault();
        let btn = $(this),
            wrapper = btn.closest('.mmenu__wrapper');

        wrapper.removeClass('active');
    });

    // Открытие меню
    $('.jsMenuOpen').on('click',function (e) {
        e.preventDefault();
        e.stopPropagation();
        openMenu();
    });

    //Закрытие меню
    $('body').on('click', function (e) {
        let target = $(e.target);

        if (target.closest('.mmenu').length == 0) {
            closeMenu();
        }
    });

    $('.jsMenuClose').on('click', function (e) {
        e.preventDefault();
        closeMenu();
    });


    // FUNCTIONS
    // Функция отрытия меню
    function openMenu() {
        let menu = $('.mmenu');
        menu.addClass('active');
        // setOverflow();
    }

    // Функция закрытия меню
    function closeMenu() {
        let menu = $('.mmenu'),
            wrappers = menu.find('.mmenu__wrapper');
        menu.removeClass('active');
        wrappers.removeClass('active');
        // removeOverflow();
    }


    //VENDORS



});
//banner.js
$(function () {

    var bannerSwiper = new Swiper('.banner__slider', {
        // Optional parameters
        direction: 'horizontal',
        watchOverflow: true,
        // If we need pagination
        pagination: {
            el: '.banner__pag-wrapper',
            clickable: true
        },
        // Navigation arrows
        navigation: {
            nextEl: '.banner__next',
            prevEl: '.banner__prev',
        }
    });
});

$(window).on('load',function () {
    let banner = $('.banner'),
        header = $('.header'),
        headerTop = header.find('.header__top'),
        headerHeight = header.outerHeight(),
        headerTopHeight = headerTop.outerHeight()-5;

    if (header.hasClass('header_second')){
        banner.css('padding-top',headerHeight+'px')
    }else {
        banner.css('padding-top',headerTopHeight+'px')
    }
});
//index.js
$(function () {

    //VARIABLES
    let sliders = $('.islider__slider'),
        slidersArr = [];


    //EVENTS

    //FUNCTIONS
    $('.itariff__circle').each(function (x, i) {

        let item = $(i),
            circle = item.find('.itariff__circle-2'),
            r = parseInt(circle.parent().outerHeight() * 0.47),
            p = 2 * Math.PI * r,
            percent = item.data('percent'),
            res = percent * p / 100;
        circle.css('stroke-dasharray', res + 'px ' + p + 'px')

    });

    //VENDORS
    sliders.each(function (x,i) {
        let slider = $(i),
            id = slider.data('id');

        slidersArr.push(new Swiper('.islider__slider[data-id="'+id+'"]', {
            // Optional parameters
            direction: 'horizontal',
            watchOverflow: true,
            slidesPerView: 2,
            spaceBetween: 10,
            // Navigation arrows
            navigation: {
                nextEl: '.islider__next[data-id="'+id+'"]',
                prevEl: '.islider__prev[data-id="'+id+'"]',
            },
            // Responsive breakpoints
            breakpoints: {
                // when window width is >= 768px
                768: {
                    slidesPerView: 3,
                    spaceBetween: 20
                }
            }
        }));

    });

});
//popup.js
$(function () {

    //VARIABLES

    //EVENTS
    $('body').on('change','.accept__input', function (e) {
        let $this = $(this),
            form = $this.closest('form'),
            btn = form.find('[type=submit]');
        btn.toggleClass('disabled');
    });

    popup.on('click', function (e) {
        let target = $(e.target);

        if (target.closest('.popup__wrapper').length == 0 ){
            closePopup();
        }
    });

    $('body',).on('click','.jsFormClose',function (e) {
        e.preventDefault();
        closePopup();
    });

    //FUNCTIONS


    //VENDORS

});



//# sourceMappingURL=main.min.js.map